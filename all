from types import NoneType

import libs.fltk as fltk
from libs.fltk import FltkEvent

from src.engine.structs.dungeon import *

from src.game.game_config import *
from src.game.state_manager import *


def handle_start_menu_event(input_event: FltkEvent | NoneType, game_context: GameContextT):
    ev = fltk.type_ev(fltk.attend_ev())

    if ev == "ClicGauche":
        # set dungeon that was selected (clicked)
        print("seted dungeon")
        game_context[GAME_CONTEXT_DUNGEON] = selected_dungeon
        game_context[GAME_CONTEXT_GAME_STATE] = STATE_GAME_DUNGEON

def handle_normal_game_event(input_event: FltkEvent | NoneType, game_context: GameContextT):
    print("game event !")

def handle_input(input_event: FltkEvent | NoneType, game_context: GameContextT):
    if isinstance(input_event, NoneType):
        return

    game_state = game_context[GAME_CONTEXT_GAME_STATE]
    print(f"game state: {game_state}")
    if game_state == STATE_MENU_START:
        handle_start_menu_event(input_event, game_context)
    elif game_state == STATE_GAME_DUNGEON:
        handle_normal_game_event(input_event, game_context)
